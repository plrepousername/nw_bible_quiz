<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bibel Quiz (NWÜ)</title>
<link rel="stylesheet" href="css/style.css">
</head>
<body>
<!-- Passwortschutz Overlay -->
<div id="pw-gate-backdrop" style="position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.7);z-index:2147483647;padding:16px;box-sizing:border-box;">
  <div id="pw-gate" role="dialog" aria-modal="true" aria-labelledby="pw-title" style="width:100%;max-width:420px;background:#fff;border-radius:16px;padding:24px;box-shadow:0 10px 30px rgba(0,0,0,.2);font-family:system-ui,-apple-system,'Segoe UI',Roboto,Ubuntu,'Helvetica Neue',Arial;box-sizing:border-box;">
    <h1 id="pw-title">Testzugang</h1>
    <p>Bitte Passwort eingeben, um fortzufahren.</p>
    <form>
      <input type="password" placeholder="Passwort" autocomplete="current-password" required />
      <button type="submit">OK</button>
    </form>
    <div class="msg" aria-live="polite"></div>
  </div>
</div>
<main id="quiz-layout">
<!-- Info Panel -->
<div id="info-panel" class="hidden">
  <h2 id="info-panel-title">Quiz Informationen</h2>
  <div class="info-item"><strong>Sprache:</strong> <span id="info-selected-language">Deutsch</span></div>
  <div class="info-item"><strong>Ausgewählte Bücher:</strong> <span id="info-selected-books">Alle verfügbaren Bücher</span></div>
  <div class="info-item"><strong>Ausgew. Schwierigkeit:</strong> <span id="info-selected-difficulty">Nicht festgelegt</span></div>
  <hr>
  <h3 id="info-current-question-title">Aktuelle Frage:</h3>
  <div class="info-item"><strong>Buch:</strong> <span id="info-current-book">-</span></div>
  <div class="info-item"><strong>Schwierigkeit:</strong> <span id="info-current-difficulty">-</span></div>
  <hr>
  <h3 id="info-progress-title">Fortschritt (Runde):</h3>
  <div class="info-item"><strong>Frage:</strong> <span id="info-question-counter">- / -</span></div>
  <div class="info-item"><strong>Richtig:</strong> <span id="info-score-counter">0</span></div>
  <div class="info-item"><strong>Quote (Runde):</strong> <span id="info-accuracy-quote">0 %</span></div>
</div>
<!-- App Container -->
<div id="app-container">
  <!-- Start Screen -->
  <div id="start-screen">
    <h1 id="app-title">Bibel Quiz (NWÜ)</h1>
    <div id="loading-message" class="hidden">Lade Fragen...</div>
    <div id="error-message" class="hidden"></div>
    <label for="language-select">Sprache wählen:</label>
    <select id="language-select">
      <option value="de">Deutsch</option>
      <option value="eng">English</option>
      <option value="ron">Romana</option>
    </select>
    <br><br>
    <label>Bibelbücher auswählen:</label>
    <button id="open-book-select-modal-btn" class="utility-btn full-width-btn" disabled>Bücher wählen...</button>
    <br><br>
    <label for="difficulty-select">Schwierigkeitsgrad:</label>
    <select id="difficulty-select" disabled>
      <option value="">Alle Schwierigkeiten</option>
      <option value="einfach">Einfach</option>
      <option value="mittel">Mittel</option>
      <option value="schwer">Schwer</option>
    </select>
    <br><br>
    <button id="start-quiz-btn" disabled>Quiz starten</button>
    <button id="show-stats-page-btn" class="utility-btn full-width-btn" style="margin-top:10px;background-color:#4caf50;" disabled>Statistiken anzeigen</button>
    <div id="installation-info" class="info-box">
      <h4>App installieren?</h4>
      <p>Du kannst diese Quiz-App auch zu deinem Startbildschirm hinzufügen, um sie wie eine normale App zu nutzen!</p>
      <p><strong>Android (Chrome/Edge):</strong> Tippe auf die drei Punkte (Menü) oben rechts und wähle dann "Zum Startbildschirm hinzufügen" oder "App installieren".<br>
      <strong>iOS (Safari):</strong> Tippe auf das Teilen-Symbol und wähle dann "Zum Home-Bildschirm".</p>
    </div>
    <div class="icon-button-wrapper">
      <button id="share-btn" class="icon-btn" aria-label="App teilen">
        <img src="data/share_button.png" alt="Teilen" class="icon" />
      </button>
      <button id="info-btn" class="icon-btn" aria-label="Info anzeigen">
        <img src="data/info_icon.webp" alt="" class="icon" />
      </button>
    </div>
    <div id="info-overlay" class="hidden">
      <div class="info-box-content">
        <button id="close-info-btn" class="close-btn" aria-label="Schließen">×</button>
        <h2 id="info-title"></h2>
        <section id="info-general">
          <h3 id="info-general-title"></h3>
          <p id="info-general-text"></p>
        </section>
        <section id="info-technical">
          <h3 id="info-technical-title"></h3>
          <p id="info-technical-text"></p>
        </section>
        <section id="info-disclaimer">
          <h3 id="info-disclaimer-title"></h3>
          <p id="info-disclaimer-text"></p>
        </section>
        <section id="info-greeting">
          <h3 id="info-greeting-title"></h3>
          <p id="info-greeting-text"></p>
        </section>
      </div>
    </div>
  </div>
  <!-- Quiz Screen -->
  <div id="quiz-screen" class="hidden" tabindex="-1">
    <div id="current-question-meta" class="hidden">
      <span id="current-q-book"></span> | <span id="current-q-difficulty"></span>
    </div>
    <h2 id="question-text" tabindex="-1">Fragetext hier</h2>
    <div id="answer-buttons">
      <button class="answer-btn"></button>
      <button class="answer-btn"></button>
      <button class="answer-btn"></button>
      <button class="answer-btn"></button>
    </div>
    <div id="feedback-section" class="hidden">
      <p id="explanation-text"></p>
      <div class="verse-display">
        <p id="verse-label"><strong><span id="verse-label-text">Bibelstelle:</span> <span id="verse-reference"></span></strong></p>
        <blockquote id="verse-content-direct"></blockquote>
      </div>
    </div>
    <div id="quiz-navigation-buttons">
      <button id="next-question-btn" class="hidden">Nächste Frage</button>
      <button id="back-to-start-btn" class="button-secondary">Zurück zum Menü</button>
    </div>
  </div>
  <!-- Stats Page -->
  <div id="stats-page" class="hidden">
    <button id="back-to-start-from-stats-btn" class="button-secondary">← <span>Zurück zum Start</span></button>
    <h2>Deine Quiz-Statistiken</h2>
    <div class="stats-section">
      <h3>Gesamtübersicht</h3>
      <div class="stat-item"><strong>Insgesamt beantwortet:</strong> <span>0</span></div>
      <div class="stat-item"><strong>Insgesamt richtig:</strong> <span>0</span></div>
      <div class="stat-item"><strong>Gesamt-Trefferquote:</strong> <span>0 %</span></div>
    </div>
    <div class="stats-section">
      <h3>Statistik pro Bibelbuch</h3>
      <div id="stats-by-book-container">
        <p>Noch keine Statistiken für einzelne Bücher vorhanden.</p>
      </div>
    </div>
    <button id="reset-all-stats-btn" class="utility-btn small-btn">Alle Statistiken zurücksetzen</button>
  </div>
</div>
</main>
<!-- Book Select Modal -->
<div id="book-select-modal" class="modal hidden">
  <div class="modal-content">
    <button class="close-modal-btn">×</button>
    <h2>Bibelbücher auswählen</h2>
    <div id="modal-book-buttons-container"></div>
    <button id="confirm-book-selection-btn">Auswahl bestätigen</button>
  </div>
</div>
<script>
  const PASS="1914";
  const STORAGE_KEY="pw_gate_unlocked";
  const backdrop=document.getElementById("pw-gate-backdrop");
  const input=backdrop.querySelector("input[type=password]");
  const form=backdrop.querySelector("form");
  const msg=backdrop.querySelector(".msg");
  try{
    const ok=JSON.parse(localStorage.getItem(STORAGE_KEY)||"null");
    if(ok && ok.unlocked){
      backdrop.remove();
    }
  }catch(_){}
  form.addEventListener("submit",function(e){
    e.preventDefault();
    if(input.value.trim()===PASS){
      localStorage.setItem(STORAGE_KEY,JSON.stringify({unlocked:true}));
      backdrop.remove();
    }else{
      msg.textContent="Falsches Passwort.";
      input.value="";
      input.focus();
    }
  });
  setTimeout(()=>input.focus(),100);
</script>
<script defer src="js/script.js"></script>
</body>
</html>
